# Arknights: Endfield Database

アークナイツ：エンドフィールドの製品・レシピデータベースと効率分析。

## 概要

このリポジトリは以下を提供します：

1. **製品データベース** - 拠点取引で出荷可能な製品の一覧と取引券価格
2. **レシピデータベース** - 一次原材料から最終製品までの全生産チェーン
3. **効率分析** - 電力コストを含めた実効利益率の比較

## ファイル構成

```
endfield_db/
├── README.md                    # このファイル
├── valley4_products.json        # 四号谷地の出荷製品データベース
├── wuling_products.json         # 武陵の出荷製品データベース
├── recipes.json                 # 生産レシピ・マシン電力データベース
└── docs/
    ├── valley4_analysis.md      # 四号谷地 出荷製品の効率分析
    └── wuling_analysis.md       # 武陵 出荷製品の効率分析
```

## データベース

### valley4_products.json

四号谷地（Valley IV）で拠点取引可能な全14製品。

```json
{
  "id": "sc_valley_battery",
  "name_ja": "中容量谷地バッテリー",
  "name_en": "SC Valley Battery",
  "trade_value": 30
}
```

### wuling_products.json

武陵（Wuling）で拠点取引可能な全4製品。

```json
{
  "id": "lc_wuling_battery",
  "name_ja": "小容量武陵バッテリー",
  "name_en": "LC Wuling Battery",
  "trade_value": 25
}
```

### recipes.json

全39レシピと10種のマシン電力データ（四号谷地・武陵共通）。

```json
{
  "machines": {
    "grinding_unit": { "name_en": "Grinding Unit", "power": 50 },
    "forge_of_the_sky": { "name_en": "Forge of the Sky", "power": 50, "region": "wuling" }
  },
  "recipes": {
    "xiranite": {
      "machine": "forge_of_the_sky",
      "time_sec": 2,
      "inputs": { "stabilized_carbon": 2, "clean_water": 1 },
      "outputs": { "xiranite": 1 },
      "region": "wuling"
    }
  }
}
```

## 効率分析

採掘・栽培の電力コストを含めた完全なコスト分析を行っています。

### 言葉の定義

- 地域：四号谷地、武陵などを指す
- 拠点：それぞれの地域に存在する、取引が可能な場所。例えば四号谷地では仮設居住地、建設基地、再建管理本部の3つ。武陵では現在1つのみ。
- 取引券：**地域ごと**に存在する固有の通貨。

### 最適化に対する考え方

エンドフィールドの生産ポートフォリオのプランニングは、与えられた有限の鉱物資源採掘レートに対して、最大の取引券出荷効率を求める問題だと考えることができる。
二次目標として**最小手動売却間隔**を取り、これが長期であるほど優れた工場（メンテナンスの手間が少ない）と見なせる。

前提条件：
- それぞれの地域において、得ることのできる鉱物資源のレートは有限
  - TODO：ここに四号谷地、武陵の最大拡張時の採掘資源レートの表を挿入
- 資源ごとの貯蓄上限は有限。
  - TODO：ここに四号谷地、武陵の最大拡張時の貯蓄上限を書く
- 製品の売却は人間が手動で行う必要がある。
  - **最小手動売却間隔**を長くしたい場合は、単価の高い製品もしくは、生産ポートフォリオの分散が有利となる。
- 地域の各拠点ごとに、取引券の貯蓄レートと貯蓄上限が存在
  - 拠点に蓄積されている取引券を得る形で販売を行う
  - 拠点に蓄積されている以上製品を販売することはできない
    - 従って、拠点の取引券貯蓄レートが実質的な販売上限
  - TODO：ここに各拠点の取引券の蓄積レートと上限、到達するまでの時間を書く

基本的な戦略：
- 目標とする**最小売却間隔** （=ログイン頻度）を決める
- 各製品が非ログイン期間に貯蓄上限に到達せず、消費する鉱物資源の量が生産を下回らない範囲で、最も効率の良い製品ポートフォリオを計算可能
- 拠点ごとに扱う商品が違うため、それぞれの拠点で販売可能な製品を用意する必要がある

### 実質コストに対する考え方

#### 電力のコスト

- 地域間転送は非常に低速なため、バッテリーを用いた電力輸送は実質的に不可能。
  - 従って電力は現地のバッテリー生産で得る必要がある。
- バッテリーは取引が可能なため、その取引価格を用いて、電力当たりの取引券コストを試算可能。これは地域ごとに異なる
  - 電力は、それを消費せずにバッテリーとして売却した場合に得られるはずの利益の機会損失として考えることができる

#### 原材料のコスト

ある製品の販売価格の効率の良さを評価するには、電力と同等に原材料の鉱石をどのくらい消費するかを勘案する必要がある。

- 単一種類の鉱石（＋植物/水）を原料とする、最も単純なレシピを持つ販売可能な製品がその地域に存在する場合は、その価格から電力コストを差し引いたものを用いて、材料コスト（取引券価格）を計算する。
  - 当然、この計算は地域ごとに適用される。
- 上記の方法で単価を計算できない鉱石については、複数種類の鉱石を利用する商品の価格を用いて計算する。

なお、原材料コストは鉱石にのみ適用される。（植物/水は電気を用いて無限に生産できるため、電力コストのみ考えればよい。）

### 四号谷地

[四号谷地 出荷製品の効率分析](docs/valley4_analysis.md) では、全14製品について原材料消費レート、電力コスト、実効利益率を算出しています。

| 指標 | 最良の選択肢 |
|---|---|
| 実効利益率 | 中容量バッテリー (+10.3%) |
| 実効利益/min | 中容量バッテリー (+16.9/min) |
| 避けるべき製品 | カプセルⅠ / 缶詰Ⅰ (−27.6%) |

**主な発見:**
- 植物の栽培電力コストが重く、蕎花/シトローム/サンドリーフを使う製品は軒並み赤字
- 利益が出るのは中容量バッテリー (+10.3%)、鋼製部品 (+7.5%)、大容量バッテリー (+3.4%) の3製品のみ

### 武陵

[武陵 出荷製品の効率分析](docs/wuling_analysis.md) では、全4製品について同様の分析を行っています。

| 指標 | 結果 |
|---|---|
| 全製品 | 原価割れ（赤字） |
| 損失最小 | 息壌 (−36.7%) |
| 損失最大 | 芽針注射剤Ⅰ (−43.9%) |

**主な発見:**
- 武陵の取引は「余剰原材料の処分」目的で利用すべき（利益を期待しない）
- 芽針注射剤Ⅰは取引より戦闘消耗品として使用した方が効率的

## データソース

- [Endfield Talos Wiki (wiki.gg)](https://endfield.wiki.gg/)
- [Game8 エンドフィールド攻略](https://game8.jp/arknights-endfield)

## ライセンス

データは攻略情報の引用・整理であり、ゲーム内データの著作権は Hypergryph / Gryphline に帰属します。
